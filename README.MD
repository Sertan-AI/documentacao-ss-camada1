# DocumentaÃ§Ã£o â€” Camada 1 (V0)

> **Sistema de Cadastro e Monitoramento de Campo**  
> Sertan AI â€¢ Camada 1 â†’ Camada 2

---

## Ãndice

- [VisÃ£o](#visÃ£o)
- [Auditoria e Papel dos RepositÃ³rios](#auditoria-e-papel-dos-repositÃ³rios)
- [Contratos](#contratos)
- [Artefatos ExecutÃ¡veis](#artefatos-executÃ¡veis)
- [EvidÃªncias](#evidÃªncias)
- [Checklist de Aceite (V0)](#checklist-de-aceite-v0)

---

## VisÃ£o

Este repositÃ³rio contÃ©m a **documentaÃ§Ã£o tÃ©cnica completa** da Camada 1 do sistema de monitoramento de campo da Sertan AI.

**Objetivo**: Estabelecer um **contrato tÃ©cnico inequÃ­voco** entre a Camada 1 (Monitoramento de Campo) e a Camada 2 (XAI/SHAP), definindo:

- âœ… Quais dados sÃ£o entregues
- âœ… Quando os dados estÃ£o prontos para consumo
- âœ… Em que formato e com quais garantias tÃ©cnicas
- âœ… O que **nÃ£o** Ã© responsabilidade da Camada 1

**VersÃ£o**: V0 (MVP)  
**Status**: âœ… ConcluÃ­do, aguardando aceite da Camada 2

---

## Auditoria e Papel dos RepositÃ³rios

### RepositÃ³rio Principal: [sertanai-app](https://github.com/Sertan-AI/sertanai-app)

**Papel**: AplicaÃ§Ã£o principal onde o **Loop MVP ocorre de ponta a ponta**

- âœ… **Fonte primÃ¡ria da verdade operacional** da Camada 1
- âœ… CÃ³digo-fonte completo do sistema de monitoramento
- âœ… Pipeline de execuÃ§Ã£o end-to-end

**DocumentaÃ§Ã£o inclui**:
- VisÃ£o Geral
- Funcionalidades Principais
- Arquitetura em Alto NÃ­vel
- Requisitos para ExecuÃ§Ã£o Local
- ConfiguraÃ§Ã£o do Ambiente
- ConfiguraÃ§Ã£o do Banco de Dados
- Executando o App Localmente
- Estrutura de Pastas (resumo)
- DemonstraÃ§Ã£o Visual
- Checklist RÃ¡pido de Problemas Comuns
- LicenÃ§a e Uso Interno

**Foco**: InstruÃ§Ãµes para execuÃ§Ã£o local, desenvolvimento e colaboraÃ§Ã£o interna. Conceitos bÃ¡sicos operacionais.

### RepositÃ³rio de DocumentaÃ§Ã£o: [documentacao-ss-camada1](https://github.com/Sertan-AI/documentacao-ss-camada1)

**Papel**: DocumentaÃ§Ã£o tÃ©cnica completa do **Contrato de Dados** (este repositÃ³rio)

- âœ… **Fonte oficial dos contratos** entre Camada 1 e Camada 2
- âœ… EspecificaÃ§Ãµes tÃ©cnicas detalhadas
- âœ… EvidÃªncias de aceite e validaÃ§Ã£o

**Foco**: Contratos, schemas, garantias tÃ©cnicas, evidÃªncias e checklist de aceite do V0.

---

## Contratos

### Contrato Principal

**[Contrato de Dados: Camada 1 â†’ Camada 2](contrato_de_dados.md)**  
Documento central que define todos os aspectos tÃ©cnicos do contrato entre camadas.

### Contratos EspecÃ­ficos

| Contrato | DescriÃ§Ã£o | Link |
|----------|-----------|------|
| **Campo `talhao_id` (V0)** | Contrato semÃ¢ntico do identificador de talhÃ£o | [docs_talhao_id.md](docs_talhao_id.md) |
| **Contrato do Tempo (V0)** | Timestamps (UTC), `observed_at` vs `created_at` | [contrato_de_dados.md#-contrato-do-tempo-v0](contrato_de_dados.md#-contrato-do-tempo-v0) |
| **Loop MVP** | Fluxo operacional mÃ­nimo do produto | [loop_monitor.md](loop_monitor.md) |

### DocumentaÃ§Ã£o Auxiliar

| Documento | DescriÃ§Ã£o | Link |
|-----------|-----------|------|
| **Modelo de Dados** | ERD, tabelas, relacionamentos, Query MÃ£e | [docs_monitoramento_relacionamento.md](docs_monitoramento_relacionamento.md) |

---

## Artefatos ExecutÃ¡veis

### Query MÃ£e (Golden Query)

**Arquivo**: [query_sessao_completa_v0.sql](query_sessao_completa_v0.sql)

**DescriÃ§Ã£o**: Query SQL completa que recupera **todos os dados de uma sessÃ£o de monitoramento** em uma Ãºnica execuÃ§Ã£o (metadados, pontos, observaÃ§Ãµes, rota, zonas).

**Retorno**: 1 linha JSON estruturada.

> **âš ï¸ IMPORTANTE**: Esta query requer:
> - **PostgreSQL/PostGIS** conectado
> - **DBeaver** ou cliente SQL compatÃ­vel
> - Substituir `:sessao_id` por um ID existente no banco
> 
> **NÃ£o Ã© um executÃ¡vel standalone** - requer ambiente configurado.

**EvidÃªncias de execuÃ§Ã£o**:

| ExecuÃ§Ã£o no DBeaver | Resultado da Query |
|:-------------------:|:------------------:|
| ![ExecuÃ§Ã£o](static/demo/golden_query_execucao.png) | ![Resultado](static/demo/golden_query_resultado.png) |
| *Interface do DBeaver executando a query* | *Dados retornados em formato JSON* |

---

## EvidÃªncias

### Galeria de EvidÃªncias

Todas as evidÃªncias tÃ©cnicas estÃ£o organizadas em:

ğŸ“‚ **[static/demo/](static/demo/)**

As evidÃªncias estÃ£o **contextualizadas** nos documentos onde sÃ£o relevantes:

- **[Contrato de Dados](contrato_de_dados.md)**: ContÃ©m galeria completa de evidÃªncias (A-I) com prints do banco, interface, exports, etc.
- **[Loop Monitor](loop_monitor.md)**: EvidÃªncias de rastreabilidade completa de observaÃ§Ãµes
- **[Query MÃ£e](static/demo/)**: EvidÃªncias de execuÃ§Ã£o e resultados da Golden Query

### Lista de EvidÃªncias DisponÃ­veis

| EvidÃªncia | Tipo | Onde estÃ¡ documentada |
|-----------|------|-----------------------|
| Trigger (`status = 'concluida'`) | Banco + Interface | [contrato_de_dados.md](contrato_de_dados.md#%EF%B8%8F-trigger-tÃ©cnico-contrato) |
| Geometrias vÃ¡lidas (SRID 4326) | Banco | [contrato_de_dados.md](contrato_de_dados.md#-validaÃ§Ã£o-do-srid-no-banco-de-dados) |
| ObservaÃ§Ãµes com FK vÃ¡lida | Banco | [contrato_de_dados.md](contrato_de_dados.md#-checklist-de-evidÃªncias-obrigatÃ³rias-aceite-do-contrato) |
| Severidade obrigatÃ³ria | Backend + Frontend | [contrato_de_dados.md](contrato_de_dados.md#-checklist-de-evidÃªncias-obrigatÃ³rias-aceite-do-contrato) |
| Cardinalidade pontoâ†”observaÃ§Ã£o | CSV + Print | [contrato_de_dados.md](contrato_de_dados.md#-galeria-de-evidÃªncias) |
| RecuperaÃ§Ã£o de sessÃ£o | Interface | [contrato_de_dados.md](contrato_de_dados.md#-galeria-de-evidÃªncias) |
| Export GeoJSON/SHP | Arquivos | [contrato_de_dados.md](contrato_de_dados.md#-galeria-de-evidÃªncias) |
| Rastreabilidade completa | SQL + Print | [loop_monitor.md](loop_monitor.md#-rastreio-completo-obs-doenÃ§a--doenÃ§a--ponto--sessÃ£o) |
| Golden Query (execuÃ§Ã£o) | DBeaver | [static/demo/golden_query_execucao.png](static/demo/golden_query_execucao.png) |
| Golden Query (resultado) | DBeaver | [static/demo/golden_query_resultado.png](static/demo/golden_query_resultado.png) |

---

## Checklist de Aceite (V0)

### Contratos Formais

- [x] **0.1 Contrato `talhao_id` existe**  
  â†’ [docs_talhao_id.md](docs_talhao_id.md) â€” SemÃ¢ntica, garantias e breaking changes

- [x] **0.2 Contrato do Tempo existe**  
  â†’ [contrato_de_dados.md (linhas 292-328)](contrato_de_dados.md#L292-L328) â€” Timestamps UTC, `observed_at` vs `created_at`, ordenaÃ§Ã£o temporal

- [x] **0.3 Golden Query existe**  
  â†’ [query_sessao_completa_v0.sql](query_sessao_completa_v0.sql) â€” Query MÃ£e executÃ¡vel (requer DBeaver + PostgreSQL)

### EvidÃªncias TÃ©cnicas

- [x] **EvidÃªncias anexadas**  
  â†’ [static/demo/](static/demo/) â€” Galeria completa documentada no [Contrato de Dados](contrato_de_dados.md#-galeria-de-evidÃªncias)

### CritÃ©rios Operacionais

- [x] **CritÃ©rios operacionais validados**  
  â†’ [contrato_de_dados.md](contrato_de_dados.md#-checklist-de-evidÃªncias-obrigatÃ³rias-aceite-do-contrato)
  
  Incluindo:
  - âœ… Trigger: `monitor_sessao.status = 'concluida'`
  - âœ… Geometrias: SRID 4326, `ST_IsValid = true`
  - âœ… Timestamps: UTC, servidor-side, ordenaÃ§Ã£o nÃ£o regressiva
  - âœ… Severidade: obrigatÃ³ria, validada frontend + backend
  - âœ… Cardinalidade: respeitada e evidenciada
  - âœ… NDVI: processo upstream nÃ£o persistido (claramente documentado)
  - âœ… Unicidade de sessÃ£o: declarada como soft rule (sem constraint)

---

## CritÃ©rio de Pronto

âœ… **Este checklist pode ser "carimbado" com um print para validaÃ§Ã£o do V0.**

Todos os itens estÃ£o **verificados, documentados e evidenciados**.

---

## InformaÃ§Ãµes de Versionamento

| Item | Valor |
|------|-------|
| **VersÃ£o** | V0 (MVP) |
| **Data de criaÃ§Ã£o** | Dezembro 2025 |
| **Ãšltima atualizaÃ§Ã£o** | 28-12-2025 |
| **ResponsÃ¡vel** | Samuel Santos (Camada 1) |
| **Consumidores** | Camada 2 (XAI/SHAP), Backend-hub |
| **Status** | â³ Aguardando aceite da Camada 2 |

---

## Links RÃ¡pidos

### DocumentaÃ§Ã£o e Contratos

- ğŸŒ **DocumentaÃ§Ã£o Interativa do banco de dados**: [https://sertan-ai.github.io/documentacao-ss-camada1](https://sertan-ai.github.io/documentacao-ss-camada1)
- ğŸ“„ **Contrato de Dados**: [contrato_de_dados.md](contrato_de_dados.md)
- ğŸ”„ **Loop MVP**: [loop_monitor.md](loop_monitor.md)
- ğŸ—ºï¸ **Modelo de Dados**: [docs_monitoramento_relacionamento.md](docs_monitoramento_relacionamento.md)
- ğŸ“Š **Query MÃ£e**: [query_sessao_completa_v0.sql](query_sessao_completa_v0.sql)

### Mockups da DocumentaÃ§Ã£o Interativa

| PÃ¡gina Inicial | Esquema TÃ©cnico Detalhado |
|:--------------:|:-------------------------:|
| <a href="static/demo/mockup_home.png" target="_blank"><img src="static/demo/mockup_home.png" alt="PÃ¡gina Inicial" style="width: 300px; height: auto;"></a> | <a href="static/demo/mockup_schema.png" target="_blank"><img src="static/demo/mockup_schema.png" alt="Esquema TÃ©cnico" style="width: 300px; height: auto;"></a> |
| *PÃ¡gina inicial da documentaÃ§Ã£o HTML* | *VisualizaÃ§Ã£o do esquema do banco de dados* |

---

<div align="center">

*Documento tÃ©cnico â€¢ Sertan AI â€¢ Camada 1 â€” Monitoramento de Campo*

[![GitHub](https://img.shields.io/badge/GitHub-DocumentaÃ§Ã£o-blue?style=for-the-badge&logo=github)](https://github.com/Sertan-AI/documentacao-ss-camada1)

</div>
